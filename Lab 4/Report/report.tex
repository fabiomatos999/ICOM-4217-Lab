\documentclass[journal]{IEEEtran} \hyphenation{op-tical net-works
  semi-conduc-tor} \usepackage{textgreek} \usepackage{graphicx}
\usepackage{listings} \usepackage{hyperref} \usepackage{float}
\usepackage{tabularx}

\newcommand\createfigure[2]{
  \begin{figure}[H]
    \centering \includegraphics[width=0.4\textwidth]{#1}
    \caption{#2}
  \end{figure}}

\begin{document}
\title{Experiment 4 Complementary Tasks\\ Lab Report} \author{Fabio J. Matos
  Nieves (802-18-6134), Enrique Chompre Gonzalez (802-18-6106), \\Guillermo Col√≥n Bernardi (802-16-1272)}
\maketitle
\begin{abstract}
  The purpose of this document is to detail implementations of sound generation using a buzzer, using multiplex 7 segment displays and measuring the rotational speed of a object using an MSP430 microcontroller.
\end{abstract}
\begin{IEEEkeywords}
  MCU, LDC, Display, Pins, 7 segment display, Optoswitch
\end{IEEEkeywords}
\IEEEpeerreviewmaketitle

\section{Introduction}
\IEEEPARstart{T}{he} first task of this laboratory assignment consists of using the MSP430's timers to generate sound at certain frequencies using polling. A timer is a hardware peripheral included on MCUs to count up to a certain number and based on the mode selected for the timer will can reset back to zero or count down back to zero. Audible frequencies were generated by enabling or disabling the GPIO pin connected to the buzzer by setting up a timer on the MCU to a to count up to a number that is the half period of the frequency based on the clock source selected for the timer and to then toggle the buzzer pin when the timer reaches the calculated half period number. For the second task of this assignment was similar to the first but instead of using polling to check if the timer count has reached the half period, the timer is setup to send an interrupt and toggle the buzzer pin when the timer reaches the half period number. For the third task of this assignment, a 7 segment display was used to display hexadecimal numbers from 0-F. A 7 segment display is a display consisting of 8 LEDs arranged in a shape of the number 8 plus a dot on the bottom right hand side. Since the display we are using is of the common anode variety, the pin has to be low in order that the segment be lit up. For the fourth task of the assignment, an 2 piece 7 segment display was multiplex in order to substantially reduce the required I/O pins for the display. In order for a two character string to appear on the display, the displays have to switch fast enough in order for phenomena known as persistence of vision to take place and that both displays appear as they are on at the same time. The complementary task consisted of using the optoswitch to detect the rotations per minute of a rotating object by using timers.
\section{Materials and Methods}

Materials:

\begin{itemize}
  \item 1 Development Board
  \item 1 IDE Application
  \item 1 Dual 7-Segment Common Anode
  \item 10 1/4W Carbon fill resistor 220\textOmega
  \item 3 1/4W Carbon fill resistor 1K\textOmega
  \item 1 1/4W Carbon fill resistor 4.7K\textOmega
  \item 2 1/4W Carbon fill resistor 12K\textOmega
  \item 1 Momentary switch
  \item 2 Optoswitch
  \item 1 Piezoelectric buzzer
  \item 2 BJT PNP transistor\\
\end{itemize}

Methods:\\

First, an audible sound was produces using delays generated by polling the timer's top count
flag. After making this, the following frequencies were used to change the tones of the buzzer using
the pushbutton connected to the MCU.\\

\begin{itemize}
  \item Clock Frequency: 32,768 Hz\\
  \item Timer's Bits: 0x110\\
  \item Preescaler used: 1/\\
\end{itemize}
\begin{table}[H]
  \ref{periods}

\begin{center}
\begin{tabularx}{0.4\textwidth}{|X|X|X|X|}
  \hline
  Frequency & Period & Period/2 & Compare register value needed\\
  \hline
  500 Hz & 2ms & 1ms & 0x20\\
  \hline
  1 KHz & 1ms & 0.5ms & 0x10\\
  \hline
  1.5 KHz & 0.667ms & 0.333ms & 0x0A\\
  \hline
  2 KHz & 0.5ms & 0.25ms & 0x07\\
  \hline
  3 KHz & 0.333ms & 0.167ms & 0x04\\
  \hline
\end{tabularx}
\caption{\label{periods}Timer MCU Periods}
\end{center}
\end{table}


In the second part of this laboratory, the MCU produced an audible sound using delays
generated by the timer's interrupt using the same setup developed before. the same
frequencies as listed in the previous table and using the pushbutton connected to the MCU to make the
frequencies change between each other. After that, a counter from 0 to F was generated displaying the number on a 7-segment display. A program was written so that every second the 7-Segmnet display changes digits using a timer ISR.

\begin{table}[H]
  \ref{segments}

\begin{center}
\begin{tabularx}{0.4\textwidth}{|X|X|X|X|X|X|X|X|X|X|}
  \hline
  \# & dp & g & f & e & d & c & b & a & 7-seg\\
  \hline
  0 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & C0h\\
  \hline
  1 & 1 & 1 & 1 & 1 & 1 & 0 & 0 & 1 & F9h\\
  \hline
  2 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & A4h\\
  \hline
  3 & 1 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & B0h\\
  \hline
  4 & 1 & 0 & 0 & 1 & 1 & 0 & 0 & 1 & 99h\\
  \hline
  5 & 1 & 0 & 0 & 1 & 0 & 0 & 1 & 0 & 92h\\
  \hline
  6 & 1 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 82h\\
  \hline
  7 & 1 & 1 & 1 & 1 & 1 & 0 & 0 & 0 & F8h\\
  \hline
  8 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 80h\\
  \hline
  9 & 1 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 90h\\
  \hline
  A & 1 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 88h\\
  \hline
  B & 1 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 83h\\
  \hline
  C & 1 & 1 & 0 & 0 & 0 & 1 & 1 & 0 & C6h\\
  \hline
  D & 1 & 0 & 1 & 0 & 0 & 0 & 0 & 1 & A1h\\
  \hline
  E & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 86h\\
  \hline
  F & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 0 & 8Eh\\
  \hline


\end{tabularx}
\caption{\label{segments}Codes for 7-segment display of digits from 0 to F}
\end{center}
\end{table}



For the other section, counter from 00 to FF was generated using multiplexing
display techniques to display the two numbers into the 7-segment display.
Here it was understood how multiplexing a 7 segment display and its implications work. Finally, for the Complementary Task
an implementation was made of a tachometer for the encoder wheel
built in Experiment 3. An LCD was used for displaying  the speed: Speed=\#\#\#RPM.
To determine the speed of rotation of the wheel a timer and interrupts were used.

\section{Results}

\createfigure{./Figures/4.2.3.jpg}{Hardware Configuration for 4.2.3 and 4.2.4}
\createfigure{./Figures/4.3.1.jpg}{Hardware Configuration for 4.3.1}

\nocite{rojasEmbeddedSystemsDesign2016}
\nocite{LCDControllerDatasheets}
\bibliographystyle{IEEEtran}
\bibliography{./references.bib}
\end{document}
